subproject libs/asio/test ;

# bring in the rules for testing
import testing ;

project boost : $(BOOST_ROOT) ;

if $(UNIX)
{
  switch $(JAMUNAME)
  {
  case SunOS* :
    {
      SOCKET_LIBS = <find-library>socket <find-library>nsl ;
    }
  }
}

run basic_datagram_socket_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run basic_deadline_timer_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run basic_demuxer_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run basic_locking_dispatcher_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run basic_socket_acceptor_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run basic_stream_socket_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run buffer_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run buffered_read_stream_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run buffered_stream_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run buffered_write_stream_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run completion_condition_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run datagram_socket_service_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run datagram_socket_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run deadline_timer_service_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run deadline_timer_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run demuxer_service_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run demuxer_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
    <lib>@boost/libs/thread/build/boost_thread
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run error_handler_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run error_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run ipv4/address_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run ipv4/basic_host_resolver_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run ipv4/host_resolver_service_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run ipv4/host_resolver_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run ipv4/host_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run ipv4/multicast_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run ipv4/tcp_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run ipv4/udp_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run is_read_buffered_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run is_write_buffered_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run locking_dispatcher_service_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run locking_dispatcher_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
    <lib>@boost/libs/thread/build/boost_thread
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run placeholders_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run read_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run service_factory_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run socket_acceptor_service_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run socket_acceptor_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run socket_base_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run stream_socket_service_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run stream_socket_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run time_traits_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

run write_test.cpp
    <lib>@boost/libs/date_time/build/boost_date_time
  :
  :
  : <include>../../..
    <threading>multi
    <mingw><*><find-library>ws2_32
    <mingw><*><find-library>mswsock
    $(SOCKET_LIBS)
  ;

